import{a as T,A as v,b,c as E,j as e,r as u,R as V,B as O,G as k,T as w,d as o,e as ce,f as le,P as he,g as pe,h as ue,i as U,k as t,l as ge,m as N,n as we,D as xe,o as m,p as j,q as fe,s as S,I as L,t as l,u as me,C as je,v as P}from"./main-CFWUZTJd.js";import{I as M}from"./InputAdornment-Dr0hFmg2.js";const ye=async d=>await(await T({url:v+"/api/v2/user",params:{...d},method:"get",headers:{Authorization:"Bearer "+b.get("access_token")}})).data,Ce=async d=>await(await T({url:v+"/api/v2/user",method:"put",headers:{Authorization:"Bearer "+b.get("access_token")},data:{...d}})).data,D=E(e.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),z=E(e.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),Se=async d=>await(await T({url:v+"/api/v2/user/password",method:"put",headers:{Authorization:"Bearer "+b.get("access_token")},data:{...d}})).data,Pe=async d=>await(await T({url:v+"/api/v2/user/balance",method:"put",headers:{Authorization:"Bearer "+b.get("access_token")},data:{...d}})).data,ke=async d=>await(await T({url:v+"/api/v2/user/fund_password",method:"put",headers:{Authorization:"Bearer "+b.get("access_token")},data:{...d}})).data,Te=()=>{const[d,x]=u.useState(""),[g,I]=u.useState(1),[G,J]=u.useState(1),[B,K]=u.useState([]),[i,h]=u.useState(null),[Q,A]=u.useState(!1),[Z,q]=u.useState(""),[$,y]=u.useState(!1),[F,H]=V.useState(""),[r,f]=V.useState({password:"",confirmPassword:"",showPassword:!1,showConfirmPassword:!1}),ee=a=>{H(a.target.value)},W=async(a=1,s="")=>{try{const n=await ye({page:a,search:s});K(n.data),J(n.totalPages)}catch(n){console.error("Failed to fetch members:",n)}};u.useEffect(()=>{const a=async()=>{W(g,d)};a();const s=setInterval(a,3e3);return()=>clearInterval(s)},[g,d,$]);const ne=()=>{I(1),W(1,d)},ae=(a,s)=>{I(s)},C=(a,s)=>{h(a),q(s),A(!0)},c=()=>{h(null),q(""),A(!1)},R=a=>s=>{f({...r,[a]:s.target.value})},X=()=>{f({...r,showPassword:!r.showPassword})},Y=()=>{f({...r,showConfirmPassword:!r.showConfirmPassword})},_=a=>{a.preventDefault()},se=async()=>{var a,s;try{const n=await Ce(i);(n==null?void 0:n.ok)===!0&&l("Thông báo",n==null?void 0:n.message,"success").then(()=>{c(),y(p=>!p),h(null)})}catch(n){l("Thông báo",(s=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:s.message,"error")}},te=async()=>{var a,s;try{if(r.password!==r.confirmPassword)return l("Thông báo","Mật khẩu không khớp, vui lòng nhập đúng","error");const n=await Se({...i,...r});(n==null?void 0:n.ok)===!0&&l("Thông báo",n==null?void 0:n.message,"success").then(()=>{c(),y(p=>!p),h(null),f({password:"",confirmPassword:"",showPassword:!1,showConfirmPassword:!1})})}catch(n){l("Thông báo",(s=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:s.message,"error")}},re=async()=>{var a,s;try{if(r.password!==r.confirmPassword)return l("Thông báo","Mật khẩu không khớp, vui lòng nhập đúng","error");const n=await ke({...i,...r});(n==null?void 0:n.ok)===!0&&l("Thông báo",n==null?void 0:n.message,"success").then(()=>{c(),y(p=>!p),h(null),f({password:"",confirmPassword:"",showPassword:!1,showConfirmPassword:!1})})}catch(n){l("Thông báo",(s=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:s.message,"error")}},oe=async()=>{var a,s;try{const n=await Pe({...i,balance:F});(n==null?void 0:n.ok)===!0&&l("Thông báo",n==null?void 0:n.message,"success").then(()=>{c(),y(p=>!p),h(null),f({password:"",confirmPassword:"",showPassword:!1,showConfirmPassword:!1})})}catch(n){l("Thông báo",(s=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:s.message,"error").then(()=>{h(null),H("")})}},ie=async()=>{var a,s;try{const n=await me(i);(n==null?void 0:n.ok)===!0&&l("Thông báo",n==null?void 0:n.message,"success").then(()=>{c(),y(p=>!p),h(null)})}catch(n){l("Thông báo",(s=(a=n==null?void 0:n.response)==null?void 0:a.data)==null?void 0:s.message,"error").then(()=>{h(null),c()})}},de=()=>{switch(Z){case"edit":return e.jsxs(e.Fragment,{children:[e.jsxs(m,{children:[e.jsxs(j,{children:["Chỉnh sửa thông tin cho ",i.username]}),e.jsx(w,{autoFocus:!0,margin:"dense",id:"username",label:"Tên người dùng",type:"text",fullWidth:!0,variant:"outlined",required:!0,defaultValue:i.username,onChange:a=>h({...i,username:a.target.value})}),e.jsx(w,{margin:"dense",id:"account",label:"Tên tài khoản",type:"text",fullWidth:!0,variant:"outlined",required:!0,defaultValue:i.account,onChange:a=>h({...i,account:a.target.value})})]}),e.jsxs(S,{children:[e.jsx(o,{onClick:se,variant:"contained",color:"primary",children:"Xác nhận"}),e.jsx(o,{onClick:c,variant:"contained",color:"secondary",children:"Hủy bỏ"})]})]});case"resetPassword":return e.jsxs(e.Fragment,{children:[e.jsxs(m,{children:[e.jsxs(j,{children:["Thiết lập mật khẩu mới cho ",i.username]}),e.jsx(w,{margin:"dense",id:"password",label:"Mật khẩu mới",type:r.showPassword?"text":"password",fullWidth:!0,variant:"outlined",required:!0,autoComplete:"off",value:r.password,onChange:R("password"),InputProps:{endAdornment:e.jsx(M,{position:"end",children:e.jsx(L,{onClick:X,onMouseDown:_,edge:"end",children:r.showPassword?e.jsx(z,{}):e.jsx(D,{})})})}}),e.jsx(w,{margin:"dense",id:"confirmPassword",label:"Xác nhận mật khẩu mới",type:r.showConfirmPassword?"text":"password",fullWidth:!0,autoComplete:"off",variant:"outlined",required:!0,value:r.confirmPassword,onChange:R("confirmPassword"),InputProps:{endAdornment:e.jsx(M,{position:"end",children:e.jsx(L,{onClick:Y,onMouseDown:_,edge:"end",children:r.showConfirmPassword?e.jsx(z,{}):e.jsx(D,{})})})}})]}),e.jsxs(S,{children:[e.jsx(o,{onClick:te,variant:"contained",color:"primary",children:"Xác nhận"}),e.jsx(o,{onClick:c,variant:"contained",color:"secondary",children:"Hủy bỏ"})]})]});case"resetFundPassword":return e.jsxs(e.Fragment,{children:[e.jsxs(m,{children:[e.jsxs(j,{children:["Thiết lập mật khẩu quỹ mới cho ",i.username]}),e.jsx(w,{margin:"dense",id:"password",label:"Mật khẩu quỹ mới",type:r.showPassword?"text":"password",fullWidth:!0,variant:"outlined",required:!0,autoComplete:"off",value:r.password,onChange:R("password"),InputProps:{endAdornment:e.jsx(M,{position:"end",children:e.jsx(L,{onClick:X,onMouseDown:_,edge:"end",children:r.showPassword?e.jsx(z,{}):e.jsx(D,{})})})}}),e.jsx(w,{margin:"dense",id:"confirmPassword",label:"Xác nhận mật khẩu mới",type:r.showConfirmPassword?"text":"password",fullWidth:!0,autoComplete:"off",variant:"outlined",required:!0,value:r.confirmPassword,onChange:R("confirmPassword"),InputProps:{endAdornment:e.jsx(M,{position:"end",children:e.jsx(L,{onClick:Y,onMouseDown:_,edge:"end",children:r.showConfirmPassword?e.jsx(z,{}):e.jsx(D,{})})})}})]}),e.jsxs(S,{children:[e.jsx(o,{onClick:re,variant:"contained",color:"primary",children:"Xác nhận"}),e.jsx(o,{onClick:c,variant:"contained",color:"secondary",children:"Hủy bỏ"})]})]});case"updateBalance":return e.jsxs(e.Fragment,{children:[e.jsxs(m,{children:[e.jsxs(j,{children:["Nhập số dư mới cho ",i.username]}),e.jsx(w,{margin:"dense",id:"newBalance",label:"Số dư mới",type:"number",fullWidth:!0,variant:"outlined",required:!0,value:F,onChange:ee})]}),e.jsxs(S,{children:[e.jsx(o,{onClick:oe,variant:"contained",color:"primary",children:"Xác nhận"}),e.jsx(o,{onClick:c,variant:"contained",color:"secondary",children:"Hủy bỏ"})]})]});case"delete":return e.jsxs(e.Fragment,{children:[e.jsxs(m,{children:[e.jsx(fe,{children:"Xác nhận xoá thành viên"}),e.jsxs(j,{children:["Bạn có chắc chắn muốn xoá thành viên ",i.username,"?"]})]}),e.jsxs(S,{children:[e.jsx(o,{onClick:ie,variant:"contained",color:"primary",children:"Xác nhận"}),e.jsx(o,{onClick:c,variant:"contained",color:"secondary",children:"Hủy bỏ"})]})]});default:return null}};return e.jsxs(O,{sx:{padding:2,width:"100%"},children:[e.jsxs(k,{container:!0,spacing:2,children:[e.jsx(k,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsx(w,{name:"hidden",label:"Tìm kiếm",variant:"outlined",autoComplete:"off",fullWidth:!0,value:d,onChange:a=>x(a.target.value)})}),e.jsx(k,{item:!0,xs:12,sm:6,md:4,lg:3,children:e.jsx(o,{variant:"contained",onClick:ne,startIcon:e.jsx(ce,{}),children:"Tìm kiếm"})})]}),e.jsx(le,{component:he,sx:{marginTop:2},children:e.jsxs(pe,{children:[e.jsx(ue,{children:e.jsxs(U,{children:[e.jsx(t,{style:{whiteSpace:"nowrap",textTransform:"none",fontSize:14,paddingLeft:60,paddingRight:60},children:"Tên người dùng"}),e.jsx(t,{style:{whiteSpace:"nowrap",textTransform:"none",fontSize:14,paddingLeft:60,paddingRight:60},children:"Tên tài khoản ngân hàng"}),e.jsx(t,{style:{whiteSpace:"nowrap",textTransform:"none",fontSize:14,paddingLeft:60,paddingRight:60},children:"Số tài khoản ngân hàng"}),e.jsx(t,{style:{whiteSpace:"nowrap",textTransform:"none",fontSize:14,paddingLeft:60,paddingRight:60},children:"Tên ngân hàng"}),e.jsx(t,{style:{whiteSpace:"nowrap",textTransform:"none",fontSize:14,paddingLeft:60,paddingRight:60},children:"Chi nhánh"}),e.jsx(t,{style:{whiteSpace:"nowrap",textTransform:"none",fontSize:14,paddingLeft:60,paddingRight:60},children:"Tên tài khoản"}),e.jsx(t,{style:{whiteSpace:"nowrap",textTransform:"none",fontSize:14,paddingLeft:60,paddingRight:60},children:"Thời gian đăng ký"}),e.jsx(t,{style:{whiteSpace:"nowrap",textTransform:"none",fontSize:14,paddingLeft:60,paddingRight:60},children:"Thời gian đăng nhập lần cuối"}),e.jsx(t,{style:{whiteSpace:"nowrap",textTransform:"none",fontSize:14,paddingLeft:60,paddingRight:60},children:"IP đăng nhập"}),e.jsx(t,{style:{whiteSpace:"nowrap",textTransform:"none",fontSize:14,paddingLeft:60,paddingRight:60},children:"IP đăng ký"}),e.jsx(t,{style:{whiteSpace:"nowrap",textTransform:"none",fontSize:14,paddingLeft:60,paddingRight:60},children:"Số dư"}),e.jsx(t,{style:{whiteSpace:"nowrap",textTransform:"none",fontSize:14,paddingLeft:60,paddingRight:60},children:"Thao tác"})]})}),e.jsx(ge,{children:B==null?void 0:B.map(a=>e.jsxs(U,{children:[e.jsx(t,{style:{paddingLeft:60,paddingRight:60,whiteSpace:"nowrap"},children:a.username}),e.jsx(t,{style:{paddingLeft:60,paddingRight:60,whiteSpace:"nowrap"},children:a.account_name}),e.jsx(t,{style:{paddingLeft:60,paddingRight:60,whiteSpace:"nowrap"},children:a.account_number}),e.jsx(t,{style:{paddingLeft:60,paddingRight:60,whiteSpace:"nowrap"},children:a.bank_name}),e.jsx(t,{style:{paddingLeft:60,paddingRight:60,whiteSpace:"nowrap"},children:a.branch}),e.jsx(t,{style:{paddingLeft:60,paddingRight:60,whiteSpace:"nowrap"},children:a.account}),e.jsx(t,{style:{paddingLeft:60,paddingRight:60,whiteSpace:"nowrap"},children:N(a.time_register).format("DD-MM-YYYY HH:mm:ss")}),e.jsx(t,{style:{paddingLeft:60,paddingRight:60,whiteSpace:"nowrap"},children:N(a.time_last_login).format("DD-MM-YYYY HH:mm:ss")}),e.jsx(t,{style:{paddingLeft:60,paddingRight:60,whiteSpace:"nowrap"},children:a.ip_login}),e.jsx(t,{style:{paddingLeft:60,paddingRight:60,whiteSpace:"nowrap"},children:a.ip_register}),e.jsx(t,{style:{paddingLeft:60,paddingRight:60,whiteSpace:"nowrap"},children:a.balance}),e.jsxs(t,{style:{display:"flex"},children:[e.jsx(o,{variant:"contained",style:{margin:5,whiteSpace:"nowrap"},onClick:()=>C(a,"edit"),children:"Sửa đổi"}),e.jsx(o,{variant:"contained",style:{margin:5,whiteSpace:"nowrap"},onClick:()=>C(a,"resetPassword"),children:"Cài lại mật khẩu"}),e.jsx(o,{variant:"contained",style:{margin:5,whiteSpace:"nowrap"},onClick:()=>C(a,"resetFundPassword"),children:"Cài lại mật khẩu quỹ"}),e.jsx(o,{variant:"contained",style:{margin:5,whiteSpace:"nowrap"},onClick:()=>C(a,"updateBalance"),children:"Cập nhật số dư"}),e.jsx(o,{variant:"contained",style:{margin:5,whiteSpace:"nowrap"},onClick:()=>C(a,"delete"),children:"Xoá thành viên"})]})]},a.id))})]})}),e.jsx(O,{sx:{display:"flex",justifyContent:"center",marginTop:2},children:e.jsx(we,{count:G,page:g,onChange:ae,color:"primary",variant:"outlined",shape:"rounded"})}),e.jsx(xe,{open:Q,onClose:c,"aria-labelledby":"dialog-title",children:e.jsx(m,{fullWidth:!0,children:e.jsx(j,{children:i&&de()})})})]})};function Re(){return e.jsx(je,{children:e.jsx(k,{container:!0,spacing:1,children:e.jsx(k,{item:!0,xs:12,sm:12,md:12,children:e.jsx(Te,{})})})})}P.string,P.string,P.object,P.bool,P.bool;export{Re as default};
